{%  extends 'layout.html' %}

{%  block content %}

    <div>
        <ol class="breadcrumb">
            <li><a href="/admin">管理首页</a></li>
            <li><a href="/admin/content">博客列表</a></li>
            <li><span>添加博客内容</span></li>
        </ol>
        <h3 class="text-center">添加博客内容</h3>

        <form class="form-horizontal" id="form-content">
            <div class="form-group" >
                <label for="title" class="col-sm-2 control-label">内容标题：</label>
                <div class="col-sm-10">
                    <input type="text" class="form-control" id="title" name="title" placeholder="请输入内容标题">
                </div>
            </div>
            <div class="form-group" >
                <label for="category" class="col-sm-2 control-label">分类：</label>
                <div class="col-sm-10">
                    <select name="category" class="form-control" id="category" name="category" placeholder="请选择要发布的分类">
                        {% for category in categorys%}
                            <option value="{{category.id}}">{{category.name}}</option>
                        {% endfor %}
                    </select>
                </div>
            </div>

            <!--<div class="form-group" >-->
                <!--<label for="description">简介</label>-->
                <!--<input type="text" class="form-control" id="description" name="description" placeholder="内容简介">-->
            <!--</div>-->
            <div class="form-group" >
                <label for="content" class="col-sm-2 control-label">内容：</label>
                <div class="col-sm-10">
                    <script id="content" type="text/plain" style="width:100%;height:300px;"></script>
                </div>
                <!--<textarea type="text" class="form-control" id="content" name="content" placeholder="内容">-->
                <!--</textarea> -->
            </div>
            <div class="form-group text-center" >
                  <button type="submit" class="btn btn-primary">添 加</button>
            </div>
        </form>
    </div>
    <script>
                var ue = UE.getEditor('content');
        $("#form-content").find("button[type=submit]").on("click",(e)=>{
            e.preventDefault();
            let $form = $("#form-content");
            let content = UE.getEditor('content').getContent();
            console.log(content,"content");
            $.ajax({
                url: "/api/content/add",
                type: "post",
                data: {
                    title: $form.find("[name=title]").val(),
                    category:$form.find("[name=category]").val(),
                    content: content,
                },
                dataType: "json",
                success: function (rusult) {
//                    if (rusult.code == 200) {
//                        window.location.href="/admin/content/";
//                    }
                }
            })
        })
    </script>
{% endblock %}

